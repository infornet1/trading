<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scalping Strategy v2.0 - Live Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1>‚ö° SCALPING STRATEGY v2.0</h1>
                <p class="subtitle">High-Frequency Paper Trading Dashboard</p>
            </div>
            <div class="header-right">
                <div class="status-indicator" id="botStatus">
                    <span class="status-dot"></span>
                    <span class="status-text">LOADING...</span>
                </div>
            </div>
        </header>

        <!-- Quick Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Balance</div>
                <div class="stat-value" id="balance">$100.00</div>
                <div class="stat-change" id="balanceChange">+$0.00</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total P&L</div>
                <div class="stat-value" id="totalPnl">$0.00</div>
                <div class="stat-change" id="pnlPercent">+0.00%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Open Positions</div>
                <div class="stat-value" id="positions">0/2</div>
                <div class="stat-change" id="unrealizedPnl">$0.00</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">BTC Price</div>
                <div class="stat-value" id="btcPrice">$0.00</div>
                <div class="stat-change" id="btcChange">--</div>
            </div>
        </div>

        <!-- Active Scalping Signals Panel -->
        <div class="scalping-alerts-panel">
            <div class="panel">
                <div class="panel-header">
                    <h2>‚ö° Active Scalping Signals</h2>
                    <span class="signal-strength" id="signalStrength">NEUTRAL</span>
                </div>
                <div class="panel-body">
                    <div class="signal-grid">
                        <div class="signal-item" id="longSignal">
                            <div class="signal-label">LONG Setup</div>
                            <div class="signal-confidence">--%</div>
                            <div class="signal-conditions"></div>
                        </div>
                        <div class="signal-item" id="shortSignal">
                            <div class="signal-label">SHORT Setup</div>
                            <div class="signal-confidence">--%</div>
                            <div class="signal-conditions"></div>
                        </div>
                    </div>
                    <div class="market-conditions">
                        <div class="condition-item">
                            <span class="condition-label">Trend Strength:</span>
                            <span class="condition-value" id="trendStrength">--</span>
                        </div>
                        <div class="condition-item">
                            <span class="condition-label">Volatility:</span>
                            <span class="condition-value" id="volatilityLevel">--</span>
                        </div>
                        <div class="condition-item">
                            <span class="condition-label">Volume Activity:</span>
                            <span class="condition-value" id="volumeActivity">--</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="content-grid">
            <!-- Left Column -->
            <div class="content-left">
                <!-- Enhanced Scalping Indicators -->
                <div class="panel">
                    <div class="panel-header">
                        <h2>üìä Scalping Indicators</h2>
                        <span class="market-state" id="marketState">LOADING</span>
                    </div>
                    <div class="panel-body">
                        <div class="indicators-grid">
                            <!-- Trend Indicators -->
                            <div class="indicator-group">
                                <h3 class="group-title">Trend & Momentum</h3>
                                <div class="indicator-row">
                                    <div class="indicator">
                                        <span class="indicator-label">RSI (14)</span>
                                        <span class="indicator-value" id="rsiValue">--</span>
                                        <div class="indicator-bar">
                                            <div class="indicator-fill" id="rsiBar"></div>
                                        </div>
                                    </div>
                                    <div class="indicator">
                                        <span class="indicator-label">Stoch K/D</span>
                                        <span class="indicator-value" id="stochValue">--/--</span>
                                    </div>
                                </div>
                                <div class="indicator-row">
                                    <div class="indicator">
                                        <span class="indicator-label">Trend Strength</span>
                                        <span class="indicator-value" id="trendStrengthValue">--</span>
                                    </div>
                                    <div class="indicator">
                                        <span class="indicator-label">Momentum</span>
                                        <span class="indicator-value" id="momentumValue">--</span>
                                    </div>
                                </div>
                            </div>

                            <!-- EMA Alignment -->
                            <div class="indicator-group">
                                <h3 class="group-title">EMA Alignment</h3>
                                <div class="ema-status" id="emaStatus">
                                    <div class="ema-line">
                                        <span class="ema-label">EMA 5:</span>
                                        <span class="ema-value" id="ema5Value">--</span>
                                        <span class="ema-trend" id="ema5Trend">‚Üí</span>
                                    </div>
                                    <div class="ema-line">
                                        <span class="ema-label">EMA 8:</span>
                                        <span class="ema-value" id="ema8Value">--</span>
                                        <span class="ema-trend" id="ema8Trend">‚Üí</span>
                                    </div>
                                    <div class="ema-line">
                                        <span class="ema-label">EMA 21:</span>
                                        <span class="ema-value" id="ema21Value">--</span>
                                        <span class="ema-trend" id="ema21Trend">‚Üí</span>
                                    </div>
                                    <div class="alignment-status" id="alignmentStatus">
                                        <span class="status-dot"></span>
                                        <span>Alignment: --</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Volume & Volatility -->
                            <div class="indicator-group">
                                <h3 class="group-title">Volume & Volatility</h3>
                                <div class="indicator-row">
                                    <div class="indicator">
                                        <span class="indicator-label">Volume Ratio</span>
                                        <span class="indicator-value" id="volumeRatio">--</span>
                                        <div class="volume-indicator">
                                            <div class="volume-bar" id="volumeBar"></div>
                                        </div>
                                    </div>
                                    <div class="indicator">
                                        <span class="indicator-label">ATR %</span>
                                        <span class="indicator-value" id="atrPercent">--%</span>
                                    </div>
                                </div>
                                <div class="volatility-meter">
                                    <span class="meter-label">Market Volatility</span>
                                    <div class="meter-bar">
                                        <div class="meter-fill" id="volatilityMeter"></div>
                                    </div>
                                    <span class="meter-value" id="volatilityValue">LOW</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced Active Positions -->
                <div class="panel">
                    <div class="panel-header">
                        <h2>üéØ Active Positions</h2>
                        <div class="position-stats">
                            <span class="stat">Total: <span id="totalPositions">0</span></span>
                            <span class="stat">Max: <span id="maxPositions">1</span></span>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div id="positionsContainer">
                            <div class="empty-state">
                                <div class="empty-icon">üì≠</div>
                                <div class="empty-text">No active positions</div>
                                <div class="empty-subtext">Waiting for scalping signals...</div>
                            </div>
                        </div>

                        <!-- Position Template (Hidden) -->
                        <template id="positionTemplate">
                            <div class="position-card">
                                <div class="position-header">
                                    <span class="position-side long">LONG</span>
                                    <span class="position-size">0.0025 BTC</span>
                                    <span class="position-time" data-start-time="">0:45</span>
                                </div>
                                <div class="position-details">
                                    <div class="detail-row">
                                        <span class="detail-label">Entry:</span>
                                        <span class="detail-value">$42,150.25</span>
                                    </div>
                                    <div class="detail-row">
                                        <span class="detail-label">Current:</span>
                                        <span class="detail-value">$42,180.50</span>
                                    </div>
                                    <div class="detail-row">
                                        <span class="detail-label">Stop Loss:</span>
                                        <span class="detail-value stop-loss">$42,080.00</span>
                                    </div>
                                    <div class="detail-row">
                                        <span class="detail-label">Take Profit:</span>
                                        <span class="detail-value take-profit">$42,280.00</span>
                                    </div>
                                </div>
                                <div class="position-performance">
                                    <div class="pnl-display positive">
                                        <span class="pnl-amount">+$7.56</span>
                                        <span class="pnl-percent">+0.18%</span>
                                    </div>
                                    <div class="progress-bar-wrapper">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 35%"></div>
                                        </div>
                                        <div class="progress-labels">
                                            <span>SL</span>
                                            <span>Current</span>
                                            <span>TP</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Performance Stats -->
                <div class="panel">
                    <div class="panel-header">
                        <h2>üìà Performance</h2>
                    </div>
                    <div class="panel-body">
                        <div class="perf-grid">
                            <div class="perf-item">
                                <div class="perf-label">Total Trades</div>
                                <div class="perf-value" id="totalTrades">0</div>
                            </div>
                            <div class="perf-item">
                                <div class="perf-label">Win Rate</div>
                                <div class="perf-value" id="winRate">0.0%</div>
                            </div>
                            <div class="perf-item">
                                <div class="perf-label">Wins / Losses</div>
                                <div class="perf-value" id="winsLosses">0 / 0</div>
                            </div>
                            <div class="perf-item">
                                <div class="perf-label">Profit Factor</div>
                                <div class="perf-value" id="profitFactor">--</div>
                            </div>
                            <div class="perf-item">
                                <div class="perf-label">Avg P&L</div>
                                <div class="perf-value" id="avgPnl">$0.00</div>
                            </div>
                            <div class="perf-item">
                                <div class="perf-label">Best Trade</div>
                                <div class="perf-value" id="bestTrade">$0.00</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="content-right">
                <!-- Risk Management -->
                <div class="panel">
                    <div class="panel-header">
                        <h2>‚ö†Ô∏è Risk Management</h2>
                        <span class="circuit-status" id="circuitStatus">OK</span>
                    </div>
                    <div class="panel-body">
                        <div class="risk-item">
                            <div class="risk-label">Daily P&L</div>
                            <div class="risk-value" id="dailyPnl">$0.00</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="dailyPnlBar" style="width: 0%"></div>
                            </div>
                            <div class="risk-subtext">Limit: 5.0%</div>
                        </div>
                        <div class="risk-item">
                            <div class="risk-label">Max Drawdown</div>
                            <div class="risk-value" id="maxDrawdown">0.00%</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="drawdownBar" style="width: 0%"></div>
                            </div>
                            <div class="risk-subtext">Limit: 15.0%</div>
                        </div>
                        <div class="risk-item">
                            <div class="risk-label">Margin Used</div>
                            <div class="risk-value" id="marginUsed">$0.00</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="marginBar" style="width: 0%"></div>
                            </div>
                            <div class="risk-subtext" id="marginPercent">0% of balance</div>
                        </div>
                        <div class="risk-item">
                            <div class="risk-label">Consecutive Trades</div>
                            <div class="risk-value" id="consecutive">0W / 0L</div>
                        </div>
                    </div>
                </div>

                <!-- Trade History -->
                <div class="panel">
                    <div class="panel-header">
                        <h2>üìã Trade History</h2>
                        <select id="tradeFilter" class="filter-dropdown" onchange="filterTrades()">
                            <option value="">All Trades</option>
                            <option value="paper" selected>Paper Trading</option>
                            <option value="live">Live Trading</option>
                        </select>
                    </div>
                    <div class="panel-body">
                        <div id="tradesContainer">
                            <div class="empty-state">No trades yet</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-left">
                <span id="lastUpdate">Last update: --</span>
            </div>
            <div class="footer-center">
                <span id="nextUpdate">Next update in: <span id="countdown">5</span>s</span>
            </div>
            <div class="footer-right">
                <span>Scalping Strategy v2.0 | Port 5902</span>
            </div>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>
